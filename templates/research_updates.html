{% extends "base.html" %}

{% block title %}ALS Research Updates - Latest Treatments & Clinical Trials{% endblock %}

{% block extra_css %}
<style>
    :root {
        --research-primary: #0f172a;
        --research-secondary: #475569;
        --research-accent: #0077b6;
        --research-bg: #ffffff;
        --research-bg-alt: #f8fafc;
        --research-border: #e2e8f0;
        --research-success: #0077b6;
        --research-warning: #64748b;
        --research-danger: #475569;
    }

    .research-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }

    /* Header Section */
    .research-header {
        text-align: center;
        padding: 3.5rem 1rem;
        background:
            linear-gradient(135deg, rgba(15, 23, 42, 0.72) 0%, rgba(30, 64, 95, 0.65) 100%),
            url('/static/images/research_header_bg.png') center/cover no-repeat;
        border-bottom: 1px solid var(--research-border);
        margin-bottom: 3rem;
        position: relative;
    }

    .research-header h1 {
        color: #ffffff !important;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .research-header p {
        color: rgba(255, 255, 255, 0.92) !important;
    }

    .research-badge {
        background: rgba(255, 255, 255, 0.95) !important;
    }

    .research-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1.25rem;
        background: #eff6ff;
        border: 1px solid #bfdbfe;
        border-radius: 9999px;
        margin-bottom: 1rem;
    }

    .research-badge i {
        color: var(--research-accent);
        font-size: 0.875rem;
    }

    .research-badge span {
        color: #1e40af;
        font-weight: 600;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .research-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--research-primary);
        margin: 0 0 1rem 0;
        letter-spacing: -0.025em;
    }

    .research-header p {
        font-size: 1.125rem;
        color: var(--research-secondary);
        max-width: 800px;
        margin: 0 auto 1.5rem;
        line-height: 1.6;
    }

    .last-updated {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: var(--research-secondary);
        padding: 0.5rem 1rem;
        background: var(--research-bg);
        border: 1px solid var(--research-border);
        border-radius: 8px;
    }

    /* Category Tabs */
    .category-tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        border-bottom: 2px solid var(--research-border);
    }

    .category-tab {
        padding: 1rem 1.5rem;
        background: transparent;
        border: none;
        border-bottom: 3px solid transparent;
        color: var(--research-secondary);
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.2s;
    }

    .category-tab:hover {
        background: var(--research-bg-alt);
        color: var(--research-primary);
    }

    .category-tab.active {
        color: var(--research-accent);
        border-bottom-color: var(--research-accent);
    }

    /* Category Sections */
    .category-section {
        display: none;
        animation: fadeIn 0.3s ease;
    }

    .category-section.active {
        display: block;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .category-intro {
        background: var(--research-bg-alt);
        padding: 1.5rem;
        border-radius: 12px;
        border-left: 4px solid var(--research-accent);
        margin-bottom: 2rem;
    }

    .category-intro h2 {
        font-size: 1.5rem;
        color: var(--research-primary);
        margin: 0 0 0.5rem 0;
    }

    .category-intro p {
        color: var(--research-secondary);
        margin: 0;
        line-height: 1.6;
    }

    /* Research Cards */
    .research-items {
        display: grid;
        gap: 1.5rem;
    }

    .research-item {
        background: var(--research-bg);
        border: 1px solid var(--research-border);
        border-radius: 12px;
        padding: 1.5rem;
        transition: all 0.2s;
    }

    .research-item:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .research-item-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 1rem;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .research-item-title {
        flex: 1;
    }

    .research-item-title h3 {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--research-primary);
        margin: 0 0 0.25rem 0;
    }

    .research-item-subtitle {
        color: var(--research-secondary);
        font-size: 0.925rem;
    }

    /* Badges */
    .stage-badges {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .stage-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
        white-space: nowrap;
    }

    .stage-badge.early {
        background: #e0f2fe;
        color: #0369a1;
    }

    .stage-badge.mid {
        background: #f1f5f9;
        color: #475569;
    }

    .stage-badge.late {
        background: #e2e8f0;
        color: #334155;
    }

    .stage-badge.genetic {
        background: #f0f9ff;
        color: #0077b6;
    }

    .stage-badge.all {
        background: #f8fafc;
        color: #1e293b;
    }

    /* Info Grid */
    .research-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin: 1rem 0;
    }

    .info-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .info-label {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        color: var(--research-secondary);
        letter-spacing: 0.05em;
    }

    .info-value {
        color: var(--research-primary);
        font-size: 0.925rem;
        line-height: 1.5;
    }

    /* India Info Box */
    .india-info {
        background: linear-gradient(135deg, #f1f5f9 0%, #f8fafc 100%);
        border: 1px solid #cbd5e1;
        border-left: 3px solid #0077b6;
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1rem;
    }

    .india-info-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .india-info-header svg {
        width: 20px;
        height: 20px;
        color: #0077b6;
    }

    .india-info-header span {
        font-weight: 700;
        color: #334155;
        font-size: 0.875rem;
        text-transform: uppercase;
    }

    .india-info-content {
        color: #475569;
        font-size: 0.875rem;
        line-height: 1.6;
    }

    .india-info-content ul {
        margin: 0.5rem 0 0 1.25rem;
        padding: 0;
    }

    .india-info-content li {
        margin-bottom: 0.25rem;
    }

    /* Action Links */
    .research-actions {
        display: flex;
        gap: 0.75rem;
        margin-top: 1rem;
        flex-wrap: wrap;
    }

    .research-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--research-bg);
        border: 1px solid var(--research-border);
        border-radius: 6px;
        color: var(--research-accent);
        text-decoration: none;
        font-size: 0.875rem;
        font-weight: 600;
        transition: all 0.2s;
    }

    .research-link:hover {
        background: var(--research-accent);
        color: white;
        border-color: var(--research-accent);
    }

    .research-link i {
        font-size: 0.75rem;
    }

    /* Warning/Note Boxes */
    .warning-box,
    .note-box {
        padding: 1rem;
        border-radius: 8px;
        margin-top: 1rem;
        font-size: 0.875rem;
        line-height: 1.6;
    }

    .warning-box {
        background: #fef2f2;
        border-left: 4px solid var(--research-danger);
        color: #7f1d1d;
    }

    .note-box {
        background: #eff6ff;
        border-left: 4px solid var(--research-accent);
        color: #1e3a8a;
    }

    .warning-box strong,
    .note-box strong {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 700;
    }

    /* Research Hubs Section */
    .research-hubs {
        background: var(--research-bg-alt);
        border-radius: 12px;
        padding: 2rem;
        margin-top: 3rem;
    }

    .research-hubs h2 {
        font-size: 1.5rem;
        color: var(--research-primary);
        margin: 0 0 1.5rem 0;
    }

    .hub-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
    }

    .hub-card {
        background: white;
        padding: 1.25rem;
        border-radius: 8px;
        border: 1px solid var(--research-border);
    }

    .hub-card h3 {
        font-size: 1.125rem;
        color: var(--research-primary);
        margin: 0 0 0.5rem 0;
    }

    .hub-card p {
        color: var(--research-secondary);
        font-size: 0.875rem;
        margin: 0;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .research-header h1 {
            font-size: 1.875rem;
        }

        .category-tabs {
            flex-direction: column;
            border-bottom: none;
        }

        .category-tab {
            border-bottom: 1px solid var(--research-border);
            border-left: 3px solid transparent;
        }

        .category-tab.active {
            border-left-color: var(--research-accent);
            border-bottom-color: var(--research-border);
        }

        .research-info-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="research-header">
    <h1>ALS Research Updates</h1>
    <p>Comprehensive information on approved treatments, ongoing clinical trials, and emerging
        research for Amyotrophic Lateral Sclerosis (ALS/MND) with specific guidance for Indian pals</p>
    <div class="last-updated">
        <i class="fas fa-calendar-check"></i>
        <span id="lastUpdated">Last Updated: December 14, 2024</span>
    </div>
</div>

<div class="research-container">
    <!-- Category Navigation -->
    <div class="category-tabs">
        <button class="category-tab active" onclick="showCategory('approved')">
            <i class="fas fa-check-circle"></i> Approved Treatments (5)
        </button>
        <button class="category-tab" onclick="showCategory('trials')">
            <i class="fas fa-vial"></i> Clinical Trials (10)
        </button>
        <button class="category-tab" onclick="showCategory('preclinical')">
            <i class="fas fa-microscope"></i> Pre-Clinical Research (3)
        </button>
        <button class="category-tab" onclick="showCategory('initiatives')">
            <i class="fas fa-handshake"></i> Research Initiatives (India)
        </button>
    </div>

    <!-- Category: Approved Treatments -->
    <div id="category-approved" class="category-section active">
        <div class="category-intro">
            <h2>Currently Approved & Available Treatments</h2>
            <p>These medications are currently approved by regulatory authorities (FDA, EMA, PMDA) and available to ALS
                PALS. Information includes India-specific availability, cost, and accessibility.</p>
        </div>
        <div class="research-items" id="approvedTreatmentsList"></div>
    </div>

    <!-- Category: Clinical Trials -->
    <div id="category-trials" class="category-section">
        <div class="category-intro">
            <h2>Ongoing Clinical Trials (Phase 2-3)</h2>
            <p>Active clinical trials that may become available in coming years. Includes trial locations, timeline,
                expected benefits, and information on PALS access/participation from India.</p>
        </div>
        <div class="research-items" id="clinicalTrialsList"></div>
    </div>

    <!-- Category: Pre-Clinical Research -->
    <div id="category-preclinical" class="category-section">
        <div class="category-intro">
            <h2>Pre-Clinical & Early Development Research</h2>
            <p>Cutting-edge research approaches in laboratory and early development stages. These may take 5-10+ years
                to reach PALS but represent the future of ALS treatment.</p>
        </div>
        <div class="research-items" id="preclinicalResearchList"></div>
    </div>

    <!-- Category: Research Initiatives (India) -->
    <div id="category-initiatives" class="category-section">
        <div class="category-intro">
            <h2>Research Initiatives & Collaborations in India</h2>
            <p>Comprehensive overview of ALS research collaborations, genetic testing programs, clinical initiatives,
                and community-driven efforts from ALSCAS WhatsApp group discussions (2021-2025). India is moving from
                ZERO ALS research infrastructure to being part of the global research community.</p>
        </div>
        <div class="research-items" id="researchInitiativesList"></div>
    </div>

    <!-- Research Hubs Section -->
    <div class="research-hubs">
        <h2><i class="fas fa-hospital"></i> Key Research Hubs for PALS in India</h2>
        <div class="hub-grid" id="researchHubsList"></div>
    </div>

    <!-- Important Notes -->
    <div class="research-hubs" style="margin-top: 2rem;">
        <h2><i class="fas fa-exclamation-triangle"></i> Important Information</h2>
        <div id="importantNotesList"></div>
    </div>
</div>

<script>
    let researchData = null;

    // Load research data
    async function loadResearchData() {
        try {
            const response = await fetch('/api/research-categorized');
            researchData = await response.json();

            // Load initiatives data
            const initiativesResponse = await fetch('/api/research-initiatives');
            const initiativesData = await initiativesResponse.json();
            researchData.initiatives = initiativesData;

            // Update last updated date
            document.getElementById('lastUpdated').textContent =
                `Last Updated: ${new Date(researchData.last_updated).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`;

            // Render all sections
            renderApprovedTreatments();
            renderClinicalTrials();
            renderPreclinicalResearch();
            renderResearchInitiatives();
            renderResearchHubs();
            renderImportantNotes();
        } catch (error) {
            console.error('Error loading research data:', error);
        }
    }

    // Show category
    function showCategory(category) {
        // Update tabs
        document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
        event.target.closest('.category-tab').classList.add('active');

        // Update sections
        document.querySelectorAll('.category-section').forEach(section => section.classList.remove('active'));
        document.getElementById(`category-${category}`).classList.add('active');
    }

    // Render Approved Treatments
    function renderApprovedTreatments() {
        const container = document.getElementById('approvedTreatmentsList');
        const treatments = researchData.categories.approved_treatments;

        container.innerHTML = treatments.map(treatment => `
            <div class="research-item">
                <div class="research-item-header">
                    <div class="research-item-title">
                        <h3>${treatment.drug_name}</h3>
                        <div class="research-item-subtitle">
                            ${Array.isArray(treatment.brand_names.global) ? treatment.brand_names.global.join(', ') : treatment.brand_names.global}
                        </div>
                    </div>
                </div>
                
                <!-- BENEFIT CLASSIFICATION - NEW -->
                ${treatment.benefit_classification ? `
                    <div class="note-box" style="margin: 1rem 0; border-left-color: #10b981;">
                        <strong style="color: #047857;"><i class="fas fa-heartbeat"></i> What This Drug Does</strong>
                        <p><strong>Primary Effect:</strong> ${treatment.benefit_classification.primary_effect}</p>
                        <ul style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li><strong>Reverses Damage?</strong> ${treatment.benefit_classification.does_it_reverse_damage}</li>
                            <li><strong>Restores Function?</strong> ${treatment.benefit_classification.does_it_restore_function}</li>
                        </ul>
                        <p style="margin-top: 0.5rem; font-style: italic;">${treatment.benefit_classification.what_it_actually_does}</p>
                    </div>
                ` : ''}

                <!-- QUANTIFIED BENEFIT -->
                ${treatment.quantified_benefit ? `
                    <div class="research-info-grid">
                        <div class="info-item">
                            <div class="info-label">Proven Benefit</div>
                            <div class="info-value">
                                ${treatment.quantified_benefit.survival_extension ? `Survival: ${treatment.quantified_benefit.survival_extension}` : ''}
                                ${treatment.quantified_benefit.functional_decline_reduction ? `Slows decline by: ${treatment.quantified_benefit.functional_decline_reduction}` : ''}
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Who Benefits</div>
                            <div class="info-value">${treatment.quantified_benefit.who_benefits || 'All PALS'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Evidence Quality</div>
                            <div class="info-value">${treatment.quantified_benefit.evidence_quality || 'See sources'}</div>
                        </div>
                    </div>
                ` : ''}

                <!-- STAGE-SPECIFIC BENEFIT - NEW -->
                ${treatment.stage_specific_benefit ? `
                    <div style="background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                        <strong style="color: #0369a1;"><i class="fas fa-user-md"></i> Stage-Specific Recommendations</strong>
                        <div style="display: grid; gap: 0.75rem; margin-top: 0.75rem;">
                            ${treatment.stage_specific_benefit.newly_diagnosed ? `
                                <div style="padding: 0.5rem; background: white; border-radius: 4px; border-left: 3px solid #0077b6;">
                                    <strong style="color: #0369a1;">Newly Diagnosed (< 2 years):</strong> 
                                    <span style="background: ${treatment.stage_specific_benefit.newly_diagnosed.benefit_level === 'HIGHEST' ? '#e0f2fe' : '#f1f5f9'}; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">${treatment.stage_specific_benefit.newly_diagnosed.benefit_level}</span>
                                    <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem;">${treatment.stage_specific_benefit.newly_diagnosed.recommendation}</p>
                                </div>
                            ` : ''}
                            ${treatment.stage_specific_benefit.mid_stage ? `
                                <div style="padding: 0.5rem; background: white; border-radius: 4px; border-left: 3px solid #64748b;">
                                    <strong style="color: #475569;">Mid Stage (2-5 years):</strong>
                                    <span style="background: #f1f5f9; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">${treatment.stage_specific_benefit.mid_stage.benefit_level}</span>
                                    <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem;">${treatment.stage_specific_benefit.mid_stage.recommendation}</p>
                                </div>
                            ` : ''}
                            ${treatment.stage_specific_benefit.advanced_ventilator ? `
                                <div style="padding: 0.5rem; background: white; border-radius: 4px; border-left: 3px solid #334155;">
                                    <strong style="color: #1e293b;">Advanced/Ventilator:</strong>
                                    <span style="background: #e2e8f0; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">${treatment.stage_specific_benefit.advanced_ventilator.benefit_level}</span>
                                    <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem;">${treatment.stage_specific_benefit.advanced_ventilator.recommendation}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                ` : ''}

                <!-- REALISTIC EXPECTATIONS - NEW -->
                ${treatment.realistic_expectations ? `
                    <div class="warning-box" style="background: #f1f5f9; border-left-color: #0077b6; color: #334155;">
                        <strong><i class="fas fa-info-circle"></i> Realistic Expectations</strong>
                        <p>${treatment.realistic_expectations}</p>
                    </div>
                ` : ''}

                <!-- INDIA INFO -->
                ${treatment.india_info.available ? `
                    <div class="india-info">
                        <div class="india-info-header">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/></svg>
                            <span>India Availability</span>
                        </div>
                        <div class="india-info-content">
                            <strong>${treatment.india_info.accessibility || 'Available in India'}</strong>
                            ${treatment.india_info.cost_range_inr ? `<p>Cost: Rs ${treatment.india_info.cost_range_inr}</p>` : ''}
                        </div>
                    </div>
                ` : `
                    <div class="warning-box">
                        <strong>Not Available in India</strong>
                        ${treatment.india_info.future_access || treatment.india_info.status || 'Currently not available for PALS in India.'}
                    </div>
                `}

                <div class="research-actions">
                    ${treatment.sources.map(source => `
                        <a href="${source}" target="_blank" class="research-link">
                            <i class="fas fa-external-link-alt"></i>
                            View Source
                        </a>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    // Render Clinical Trials
    function renderClinicalTrials() {
        const container = document.getElementById('clinicalTrialsList');
        const trials = researchData.categories.clinical_trials;

        container.innerHTML = trials.map(trial => `
            <div class="research-item">
                <div class="research-item-header">
                    <div class="research-item-title">
                        <h3>${trial.trial_name}</h3>
                        <div class="research-item-subtitle">
                            ${trial.phase || 'Phase unknown'}
                        </div>
                    </div>
                </div>
                
                <!-- BENEFIT CLASSIFICATION -->
                ${trial.benefit_classification ? `
                    <div class="note-box" style="margin: 1rem 0; border-left-color: #8b5cf6;">
                        <strong style="color: #6d28d9;"><i class="fas fa-flask"></i> What This Trial Aims To Do</strong>
                        <p><strong>Primary Effect:</strong> ${trial.benefit_classification.primary_effect}</p>
                        <ul style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li><strong>Reverses Damage?</strong> ${trial.benefit_classification.does_it_reverse_damage}</li>
                            <li><strong>Restores Function?</strong> ${trial.benefit_classification.does_it_restore_function}</li>
                        </ul>
                        <p style="margin-top: 0.5rem;"><strong>What it promises:</strong> ${trial.benefit_classification.what_it_promises}</p>
                    </div>
                ` : ''}

                <!-- STAGE APPLICABILITY -->
                ${trial.stage_specific_applicability ? `
                    <div style="background: #faf5ff; border: 1px solid #c4b5fd; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                        <strong style="color: #6d28d9;"><i class="fas fa-user-check"></i> Who Should Consider This Trial</strong>
                        <p style="margin: 0.5rem 0;"><strong style="color: #166534;">Best for:</strong> ${trial.stage_specific_applicability.best_for}</p>
                        ${trial.stage_specific_applicability.not_for ? `<p style="margin: 0; color: #991b1b;"><strong>Not for:</strong> ${trial.stage_specific_applicability.not_for}</p>` : ''}
                        ${trial.stage_specific_applicability.requirement ? `<p style="margin: 0.5rem 0;"><strong>Requirement:</strong> ${trial.stage_specific_applicability.requirement}</p>` : ''}
                    </div>
                ` : ''}
                
                <div class="research-info-grid">
                    <div class="info-item">
                        <div class="info-label">Mechanism</div>
                        <div class="info-value">${trial.mechanism}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Timeline</div>
                        <div class="info-value">${trial.timeline}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">India Potential</div>
                        <div class="info-value">${trial.india_potential || 'Unknown'}</div>
                    </div>
                </div>

                ${trial.critical_warning ? `
                    <div class="warning-box">
                        <strong><i class="fas fa-exclamation-triangle"></i> Critical Warning</strong>
                        <p>${trial.critical_warning}</p>
                    </div>
                ` : ''}

                <div class="research-actions">
                    ${trial.clinicaltrials_id ? `
                        <a href="https://clinicaltrials.gov/study/${trial.clinicaltrials_id}" target="_blank" class="research-link">
                            <i class="fas fa-flask"></i>
                            ClinicalTrials.gov
                        </a>
                    ` : ''}
                    ${trial.sources ? trial.sources.map(source => `
                        <a href="${source}" target="_blank" class="research-link">
                            <i class="fas fa-external-link-alt"></i>
                            Learn More
                        </a>
                    `).join('') : ''}
                </div>
            </div>
        `).join('');
    }

    // Render Pre-Clinical Research
    function renderPreclinicalResearch() {
        const container = document.getElementById('preclinicalResearchList');
        const research = researchData.categories.preclinical_research;

        container.innerHTML = research.map(item => `
            <div class="research-item">
                <div class="research-item-header">
                    <div class="research-item-title">
                        <h3>${item.research_area}</h3>
                        <div class="research-item-subtitle">
                            ${item.company ? `<strong style="color: #0077b6;">${item.company}</strong><br>` : ''}
                            ${item.target || item.what_it_is || ''}
                        </div>
                    </div>
                </div>
                
                <!-- CONCEPT - What is this research -->
                ${item.concept ? `
                    <div class="note-box" style="margin: 1rem 0; border-left-color: #0077b6; background: #f0f9ff;">
                        <strong style="color: #0369a1;"><i class="fas fa-lightbulb"></i> The Concept</strong>
                        <p>${item.concept}</p>
                    </div>
                ` : ''}
                
                <!-- BENEFIT CLASSIFICATION -->
                ${item.benefit_classification ? `
                    <div class="note-box" style="margin: 1rem 0; border-left-color: #64748b; background: #f8fafc;">
                        <strong style="color: #334155;"><i class="fas fa-microscope"></i> Research Goal</strong>
                        <p><strong>Primary Effect:</strong> ${item.benefit_classification.primary_effect}</p>
                        <p>${item.benefit_classification.what_it_promises}</p>
                    </div>
                ` : ''}
                
                <div class="research-info-grid">
                    <div class="info-item">
                        <div class="info-label">Timeline</div>
                        <div class="info-value">${item.timeline || 'In development'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Stage Applicability</div>
                        <div class="info-value">${item.stage_applicability || item.pals_population || 'To be determined'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">India Relevance</div>
                        <div class="info-value">${item.india_relevance || 'Monitoring for future access'}</div>
                    </div>
                </div>

                <!-- WHO BENEFITS -->
                ${item.who_benefits ? `
                    <div class="india-info" style="margin-top: 1rem;">
                        <div class="india-info-header">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/></svg>
                            <span>Who Benefits</span>
                        </div>
                        <div class="india-info-content">
                            ${Array.isArray(item.who_benefits)
                    ? '<ul>' + item.who_benefits.map(b => '<li>' + b + '</li>').join('') + '</ul>'
                    : item.who_benefits
                }
                        </div>
                    </div>
                ` : ''}

                <!-- PARTICIPATION (for Target ALS GWAS) -->
                ${typeof item.participation === 'object' ? `
                    <div class="india-info" style="margin-top: 1rem;">
                        <div class="india-info-header">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/></svg>
                            <span>How to Participate</span>
                        </div>
                        <div class="india-info-content">
                            <p><strong>Eligibility:</strong> ${item.participation.eligibility}</p>
                            <p><strong>Cost:</strong> ${item.participation.cost}</p>
                            <p><strong>Contact:</strong> ${item.participation.how_to_participate}</p>
                        </div>
                    </div>
                ` : (item.participation ? `
                    <div class="india-info">
                        <div class="india-info-header">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/></svg>
                            <span>Participation</span>
                        </div>
                        <div class="india-info-content">${item.participation}</div>
                    </div>
                ` : '')}

                <!-- SOURCES -->
                ${item.sources && item.sources.length > 0 ? `
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                        <strong style="font-size: 0.8rem; color: #64748b;"><i class="fas fa-link"></i> Sources:</strong>
                        <span style="font-size: 0.8rem;">
                            ${item.sources.map((src, i) =>
                    `<a href="${src}" target="_blank" style="color: #0077b6; margin-left: 0.5rem;">[${i + 1}]</a>`
                ).join('')}
                        </span>
                    </div>
                ` : ''}

                <!-- KNOW MORE BUTTON (for Target ALS GWAS) -->
                ${item.research_collaboration ? `
                    <button onclick="showGWASModal()" style="
                        margin-top: 1rem; 
                        padding: 0.75rem 1.5rem; 
                        background: linear-gradient(135deg, #0077b6 0%, #0369a1 100%); 
                        color: white; 
                        border: none; 
                        border-radius: 8px; 
                        cursor: pointer; 
                        font-weight: 600;
                        font-size: 0.9rem;
                        transition: all 0.2s;
                    " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(0,119,182,0.3)'" onmouseout="this.style.transform='';this.style.boxShadow=''">
                        <i class="fas fa-info-circle"></i> Know More About This Study
                    </button>
                ` : ''}
            </div>
        `).join('');
    }

    // Target ALS GWAS Modal
    function showGWASModal() {
        const gwasData = researchData.categories.preclinical_research.find(r => r.research_collaboration);
        if (!gwasData) return;

        const modal = document.createElement('div');
        modal.className = 'modal-overlay';
        modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;display:flex;align-items:center;justify-content:center;padding:1rem;';
        modal.innerHTML = `
            <div style="background:white;border-radius:16px;max-width:800px;width:100%;max-height:90vh;overflow-y:auto;padding:2rem;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
                    <h2 style="font-size:1.5rem;color:#0f172a;margin:0;">${gwasData.full_title || gwasData.research_area}</h2>
                    <button onclick="this.closest('.modal-overlay').remove()" style="background:none;border:none;font-size:1.5rem;cursor:pointer;color:#64748b;">&times;</button>
                </div>
                
                <p style="color:#475569;line-height:1.6;margin-bottom:1.5rem;">${gwasData.concept}</p>
                
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-handshake"></i> Research Collaboration</h3>
                <div style="background:#f8fafc;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Lead Organization:</strong> ${gwasData.research_collaboration.lead_organization}</p>
                    <hr style="border:none;border-top:1px solid #e2e8f0;margin:1rem 0;">
                    <p><strong>India Sites:</strong></p>
                    ${gwasData.research_collaboration.india_sites.map(site => `
                        <div style="margin-left:1rem;margin-bottom:0.75rem;">
                            <strong style="color:#0369a1;">${site.institution}</strong><br>
                            <span style="color:#475569;">Lead: ${site.lead_researcher}</span>
                            ${site.previous_work ? `<br><em style="color:#64748b;font-size:0.9rem;">${site.previous_work}</em>` : ''}
                        </div>
                    `).join('')}
                    <hr style="border:none;border-top:1px solid #e2e8f0;margin:1rem 0;">
                    <p><strong>International Partner:</strong> ${gwasData.research_collaboration.international_partner.institution} (${gwasData.research_collaboration.international_partner.lead_researcher})</p>
                </div>
                
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-flask"></i> Study Details</h3>
                <div style="background:#f0f9ff;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Enrollment:</strong> ${gwasData.study_details.enrollment}</p>
                    <p><strong>Duration:</strong> ${gwasData.study_details.duration}</p>
                    <p><strong>Methods:</strong> ${gwasData.study_details.methods.join(', ')}</p>
                    <p style="margin-top:0.75rem;padding:0.75rem;background:#e0f2fe;border-radius:8px;color:#0369a1;">
                        <strong>Key Observation:</strong> ${gwasData.study_details.unique_observations}
                    </p>
                </div>
                
                ${gwasData.previous_indian_genetic_findings ? `
                    <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-dna"></i> Previous Indian Genetic Findings</h3>
                    <div style="background:#f1f5f9;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                        <p><strong>Most Common Mutations:</strong> ${gwasData.previous_indian_genetic_findings.most_common_mutations}</p>
                        <p><strong>Rare Variants Found:</strong> ${gwasData.previous_indian_genetic_findings.rare_variants}</p>
                    </div>
                ` : ''}
                
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-clipboard-check"></i> How to Participate</h3>
                <div style="background:#f0fdf4;border-left:4px solid #22c55e;border-radius:8px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Eligibility:</strong> ${gwasData.participation.eligibility}</p>
                    <p><strong>Cost:</strong> <span style="color:#15803d;font-weight:600;">${gwasData.participation.cost}</span></p>
                    <p><strong>Contact:</strong> ${gwasData.participation.how_to_participate}</p>
                </div>
                
                <div style="text-align:center;margin-top:1.5rem;">
                    <button onclick="this.closest('.modal-overlay').remove()" style="padding:0.75rem 2rem;background:#0077b6;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;">Close</button>
                </div>
            </div>
        `;
        modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
        document.body.appendChild(modal);
    }

    // Render Research Initiatives
    function renderResearchInitiatives() {
        const container = document.getElementById('researchInitiativesList');
        if (!researchData.initiatives || !researchData.initiatives.categories) {
            container.innerHTML = '<div class="research-item"><p>Loading research initiatives...</p></div>';
            return;
        }

        const initiatives = researchData.initiatives;
        let html = '';

        // ============================================
        // PART 1: GROUP INITIATIVES & COLLABORATIONS
        // ============================================
        html += `
            <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 16px; padding: 2rem; margin-bottom: 3rem; border: 1px solid #bae6fd;">
                <h2 style="color: #0369a1; font-size: 1.75rem; margin: 0 0 0.5rem 0; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fas fa-handshake" style="color: #0077b6;"></i>
                    Part 1: Group Initiatives & Collaborations
                </h2>
                <p style="color: #475569; margin: 0; font-size: 1rem;">
                    Active research programs, international collaborations, and institutional partnerships with exact timelines, organization links, and WhatsApp discussion context.
                </p>
            </div>
        `;

        // Genetic Testing Programs
        if (initiatives.categories.genetic_testing_programs) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #e0f2fe; padding-bottom: 0.75rem;">
                    <i class="fas fa-dna"></i> Genetic Testing Programs
                    <span style="background: #e0f2fe; color: #0369a1; font-size: 0.75rem; padding: 0.25rem 0.75rem; border-radius: 9999px; margin-left: auto;">${initiatives.categories.genetic_testing_programs.length} Programs</span>
                </h3>`;

            initiatives.categories.genetic_testing_programs.forEach(program => {
                html += `<div class="research-item" style="border-left: 4px solid #0077b6;">
                    <div class="research-item-header">
                        <div class="research-item-title">
                            <h3>${program.program_name}</h3>
                            <div class="research-item-subtitle">${program.lead_organization || program.program_type}</div>
                        </div>
                        <span class="stage-badge ${program.status.toLowerCase().includes('active') ? 'early' : 'mid'}">${program.status}</span>
                    </div>
                    ${program.lead_researcher ? `<p><strong>Lead Researcher:</strong> ${program.lead_researcher}</p>` : ''}
                    
                    ${program.genes_tested && Array.isArray(program.genes_tested) ? `
                        <div style="background: #f0f9ff; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #0369a1; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-vial"></i> Genes Tested</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                ${program.genes_tested.map(g => `<span style="background: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.85rem; border: 1px solid #bae6fd;">${g}</span>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${program.participants ? `
                        <div style="background: #f1f5f9; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #334155; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-users"></i> Participant Numbers (WhatsApp Verified)</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #475569;">
                                ${program.participants.first_batch_2022 ? `<li><strong>First Batch (Sept 2022):</strong> ${program.participants.first_batch_2022}</li>` : ''}
                                ${program.participants.november_2025_batch ? `<li><strong>Second Batch (Nov 2025):</strong> ${program.participants.november_2025_batch}</li>` : ''}
                                ${program.participants.status ? `<li><em>${program.participants.status}</em></li>` : ''}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${program.how_to_participate ? `
                        <div style="background: #f0fdf4; border-left: 4px solid #22c55e; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #15803d; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-clipboard-check"></i> How to Participate</h4>
                            <p style="margin: 0 0 0.5rem 0;"><strong>Cost:</strong> <span style="color: #15803d; font-weight: 700;">${program.how_to_participate.cost}</span></p>
                            ${program.how_to_participate.website ? `<p style="margin: 0;"><strong>Website:</strong> <a href="${program.how_to_participate.website}" target="_blank" style="color: #0077b6;">${program.how_to_participate.website}</a></p>` : ''}
                        </div>
                    ` : ''}
                    
                    ${program.providers && Array.isArray(program.providers) ? `
                        <div style="margin: 1rem 0;">
                            <h4 style="color: #334155; font-size: 0.9rem; margin-bottom: 0.75rem;"><i class="fas fa-building"></i> Commercial Providers</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                ${program.providers.map(p => `
                                    <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0;">
                                        <strong>${p.name}</strong>
                                        ${p.cost_inr ? `<p style="margin: 0.25rem 0; font-size: 0.875rem;">Cost: â‚¹${p.cost_inr}</p>` : ''}
                                        ${p.contact ? `<p style="margin: 0; font-size: 0.875rem; color: #64748b;">Contact: ${p.contact}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${program.sources && Array.isArray(program.sources) ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                            <strong style="font-size: 0.8rem; color: #64748b;"><i class="fas fa-link"></i> Sources & Discussion Context:</strong>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                ${program.sources.map((src, i) => {
                    if (src.startsWith('http')) {
                        return `<a href="${src}" target="_blank" style="color: #0077b6; margin-right: 1rem; text-decoration: underline;">[${i + 1}] ${src.includes('gomed') ? 'GOMED Program Official' : 'Reference'}</a>`;
                    } else {
                        return `<span style="color: #475569; display: block; margin: 0.25rem 0;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> ${src}</span>`;
                    }
                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>`;
            });
            html += '</div>';
        }

        // International Collaborations
        if (initiatives.categories.international_collaborations) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #e0f2fe; padding-bottom: 0.75rem;">
                    <i class="fas fa-globe"></i> International Collaborations
                    <span style="background: #e0f2fe; color: #0369a1; font-size: 0.75rem; padding: 0.25rem 0.75rem; border-radius: 9999px; margin-left: auto;">${initiatives.categories.international_collaborations.length} Collaborations</span>
                </h3>`;

            initiatives.categories.international_collaborations.forEach(collab => {
                html += `<div class="research-item" style="border-left: 4px solid #0077b6;">
                    <div class="research-item-header">
                        <div class="research-item-title">
                            <h3>${collab.collaboration_name}</h3>
                            <div class="research-item-subtitle">${collab.organization || ''}</div>
                        </div>
                        <span class="stage-badge early">${collab.status}</span>
                    </div>
                    
                    ${collab.meeting_date ? `<p style="color: #64748b; font-size: 0.9rem;"><i class="fas fa-calendar"></i> <strong>Meeting Date:</strong> ${collab.meeting_date}</p>` : ''}
                    
                    ${collab.india_partners && Array.isArray(collab.india_partners) ? `
                        <div style="background: #fff7ed; border-left: 4px solid #f97316; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #c2410c; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-hospital"></i> India Partners</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #475569;">
                                ${collab.india_partners.map(p => `<li><strong>${p.institution}:</strong> ${p.role}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${collab.participants && Array.isArray(collab.participants) ? `
                        <div style="background: #f1f5f9; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #334155; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-user-tie"></i> Meeting Participants</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #475569; font-size: 0.9rem;">
                                ${collab.participants.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${collab.goals && Array.isArray(collab.goals) ? `
                        <div style="background: #f0fdf4; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #15803d; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-bullseye"></i> Goals</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #475569; font-size: 0.9rem;">
                                ${collab.goals.map(g => `<li>${g}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${collab.has_detailed_info ? `
                        <button onclick="showCollaborationModal(${collab.id})" style="
                            margin-top: 1rem; 
                            padding: 0.75rem 1.5rem; 
                            background: linear-gradient(135deg, #0077b6 0%, #0369a1 100%); 
                            color: white; 
                            border: none; 
                            border-radius: 8px; 
                            cursor: pointer; 
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.2s;
                        " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(0,119,182,0.3)'" onmouseout="this.style.transform='';this.style.boxShadow=''">
                            <i class="fas fa-info-circle"></i> Know More About This Collaboration
                        </button>
                    ` : ''}
                    
                    ${collab.sources && Array.isArray(collab.sources) ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                            <strong style="font-size: 0.8rem; color: #64748b;"><i class="fas fa-link"></i> Organization Links & Sources:</strong>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                ${collab.sources.map((src, i) => {
                    if (src.startsWith('http')) {
                        return `<a href="${src}" target="_blank" style="color: #0077b6; margin-right: 1rem; text-decoration: underline;">[${i + 1}] ${src.includes('targetals') ? 'Target ALS Official' : src.includes('youtube') ? 'YouTube Video' : src.includes('projectmine') ? 'ProjectMinE' : src.includes('als-mnd') ? 'International Alliance' : src.includes('ihbas') ? 'IHBAS Delhi' : 'Reference'}</a>`;
                    } else {
                        return `<span style="color: #475569; display: block; margin: 0.25rem 0;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> ${src}</span>`;
                    }
                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>`;
            });
            html += '</div>';
        }

        // Hospital Initiatives
        if (initiatives.categories.hospital_initiatives) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #e0f2fe; padding-bottom: 0.75rem;">
                    <i class="fas fa-hospital-alt"></i> Hospital Initiatives
                    <span style="background: #e0f2fe; color: #0369a1; font-size: 0.75rem; padding: 0.25rem 0.75rem; border-radius: 9999px; margin-left: auto;">${initiatives.categories.hospital_initiatives.length} Hospitals</span>
                </h3>`;

            initiatives.categories.hospital_initiatives.forEach(hospital => {
                html += `<div class="research-item" style="border-left: 4px solid #0077b6;">
                    <div class="research-item-header">
                        <div class="research-item-title">
                            <h3>${hospital.institution}</h3>
                            <div class="research-item-subtitle">${hospital.key_contact || ''}</div>
                        </div>
                        <span class="stage-badge early">${hospital.status}</span>
                    </div>
                    
                    ${hospital.major_event ? `
                        <div style="background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%); border-left: 4px solid #f59e0b; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #b45309; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-star"></i> ${hospital.major_event.name}</h4>
                            <p style="margin: 0.25rem 0;"><strong>Date:</strong> ${hospital.major_event.date}</p>
                            <p style="margin: 0.25rem 0;"><strong>Venue:</strong> ${hospital.major_event.venue}</p>
                            ${hospital.major_event.capacity ? `<p style="margin: 0.25rem 0;"><strong>Capacity:</strong> ${hospital.major_event.capacity}</p>` : ''}
                            ${hospital.major_event.outcomes && Array.isArray(hospital.major_event.outcomes) ? `
                                <div style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #fcd34d;">
                                    <strong style="font-size: 0.85rem;">Key Outcomes:</strong>
                                    <ul style="margin: 0.25rem 0 0 1.25rem; padding: 0; font-size: 0.85rem;">
                                        ${hospital.major_event.outcomes.map(o => `<li>${o}</li>`).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                        </div>
                    ` : ''}
                    
                    ${hospital.initiatives && Array.isArray(hospital.initiatives) ? `
                        <div style="margin: 1rem 0;">
                            <h4 style="color: #334155; font-size: 0.9rem; margin-bottom: 0.75rem;"><i class="fas fa-tasks"></i> Active Initiatives</h4>
                            <div style="display: grid; gap: 0.75rem;">
                                ${hospital.initiatives.map(init => `
                                    <div style="background: #f8fafc; padding: 0.75rem 1rem; border-radius: 8px; border: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                                        <span style="font-weight: 600; color: #334155;">${init.name}</span>
                                        <span style="background: ${init.status.toLowerCase().includes('approved') || init.status.toLowerCase().includes('active') ? '#dcfce7' : init.status.toLowerCase().includes('discussion') ? '#fef3c7' : '#f1f5f9'}; color: ${init.status.toLowerCase().includes('approved') || init.status.toLowerCase().includes('active') ? '#15803d' : init.status.toLowerCase().includes('discussion') ? '#b45309' : '#475569'}; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600;">${init.status}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${hospital.sources && Array.isArray(hospital.sources) ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                            <strong style="font-size: 0.8rem; color: #64748b;"><i class="fas fa-link"></i> Sources:</strong>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                ${hospital.sources.map((src, i) => {
                    if (src.startsWith('http')) {
                        return `<a href="${src}" target="_blank" style="color: #0077b6; margin-right: 1rem; text-decoration: underline;">[${i + 1}] ${src.includes('nimhans') ? 'NIMHANS Official' : src.includes('aiims') ? 'AIIMS Official' : 'Reference'}</a>`;
                    } else {
                        return `<span style="color: #475569; display: block; margin: 0.25rem 0;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> ${src}</span>`;
                    }
                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>`;
            });
            html += '</div>';
        }

        // Government Collaborations
        if (initiatives.categories.government_collaborations) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #e0f2fe; padding-bottom: 0.75rem;">
                    <i class="fas fa-landmark"></i> Government Collaborations
                </h3>`;

            initiatives.categories.government_collaborations.forEach(govt => {
                html += `<div class="research-item" style="border-left: 4px solid #7c3aed;">
                    <div class="research-item-header">
                        <div class="research-item-title">
                            <h3>${govt.organization}</h3>
                        </div>
                        <span class="stage-badge mid">${govt.status}</span>
                    </div>
                    ${govt.meeting_date ? `<p style="color: #64748b; font-size: 0.9rem;"><i class="fas fa-calendar"></i> <strong>Meeting:</strong> ${govt.meeting_date}${govt.duration ? ` (${govt.duration})` : ''}</p>` : ''}
                    ${govt.discussion_topics && Array.isArray(govt.discussion_topics) ? `
                        <div style="background: #f5f3ff; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #6d28d9; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-comments"></i> Discussion Topics</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #475569; font-size: 0.9rem;">
                                ${govt.discussion_topics.map(t => `<li>${t}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    ${govt.sources && Array.isArray(govt.sources) ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                            <strong style="font-size: 0.8rem; color: #64748b;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> WhatsApp Discussion Context:</strong>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem; color: #475569;">${govt.sources.join(', ')}</div>
                        </div>
                    ` : ''}
                </div>`;
            });
            html += '</div>';
        }

        // Treatment Access Initiatives
        if (initiatives.categories.treatment_access_initiatives) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #e0f2fe; padding-bottom: 0.75rem;">
                    <i class="fas fa-pills"></i> Treatment Access Initiatives
                </h3>`;

            initiatives.categories.treatment_access_initiatives.forEach(treat => {
                html += `<div class="research-item" style="border-left: 4px solid #ec4899;">
                    <div class="research-item-header">
                        <div class="research-item-title">
                            <h3>${treat.treatment_name}</h3>
                        </div>
                        <span class="stage-badge genetic">${treat.status}</span>
                    </div>
                    ${treat.target_mutation ? `<p><strong>Target:</strong> ${treat.target_mutation}</p>` : ''}
                    ${treat.current_cost ? `<p><strong>Current Cost:</strong> <span style="color: #dc2626;">${treat.current_cost}</span></p>` : ''}
                    ${treat.india_access ? `
                        <div style="background: #fef2f2; border-left: 4px solid #ef4444; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <h4 style="color: #dc2626; margin: 0 0 0.5rem 0; font-size: 0.9rem;"><i class="fas fa-map-marker-alt"></i> India Access Status</h4>
                            <p style="margin: 0 0 0.5rem 0;"><strong>Status:</strong> ${treat.india_access.current_status}</p>
                            ${treat.india_access.recommendation ? `<p style="margin: 0 0 0.5rem 0;"><strong>Recommendation:</strong> ${treat.india_access.recommendation}</p>` : ''}
                            ${treat.india_access.program_link ? `<p style="margin: 0;"><a href="${treat.india_access.program_link}" target="_blank" style="color: #0077b6;">View Early Access Program</a></p>` : ''}
                        </div>
                    ` : ''}
                    ${treat.sources && Array.isArray(treat.sources) ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                            <strong style="font-size: 0.8rem; color: #64748b;"><i class="fas fa-link"></i> Sources:</strong>
                            <div style="font-size: 0.8rem; margin-top: 0.5rem;">
                                ${treat.sources.map((src, i) => {
                    if (src.startsWith('http')) {
                        return `<a href="${src}" target="_blank" style="color: #0077b6; display: block; margin: 0.25rem 0;">${src}</a>`;
                    } else {
                        return `<span style="color: #475569; display: block; margin: 0.25rem 0;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> ${src}</span>`;
                    }
                }).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>`;
            });
            html += '</div>';
        }

        // ============================================
        // PART 2: COMMUNITY ACHIEVEMENTS & MILESTONES
        // ============================================
        html += `
            <div style="background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%); border-radius: 16px; padding: 2rem; margin: 3rem 0; border: 1px solid #fcd34d;">
                <h2 style="color: #b45309; font-size: 1.75rem; margin: 0 0 0.5rem 0; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fas fa-trophy" style="color: #f59e0b;"></i>
                    Part 2: Community Achievements & Milestones
                </h2>
                <p style="color: #78350f; margin: 0; font-size: 1rem;">
                    Timeline of major achievements, WhatsApp community discussions, and emotional journey from zero ALS infrastructure to global recognition.
                </p>
            </div>
        `;

        // Timeline with enhanced details
        if (initiatives.timeline) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #fcd34d; padding-bottom: 0.75rem;">
                    <i class="fas fa-history"></i> Major Milestones Timeline
                </h3>`;

            // Sort timeline entries by date (most recent first for display)
            const timelineEntries = Object.entries(initiatives.timeline);

            timelineEntries.forEach(([key, value], index) => {
                const period = key.replace(/_/g, ' ').toUpperCase();
                const isRecent = index >= timelineEntries.length - 4;

                html += `
                    <div class="research-item" style="border-left: 4px solid ${isRecent ? '#f59e0b' : '#cbd5e1'}; ${isRecent ? 'background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 50%, #ffffff 100%);' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                            <div>
                                <h4 style="color: var(--research-primary); margin: 0; font-size: 1.1rem;">${value.title}</h4>
                                ${value.subtitle ? `<p style="color: #0077b6; font-weight: 600; margin: 0.25rem 0 0 0; font-size: 0.9rem;">${value.subtitle}</p>` : ''}
                            </div>
                            <span style="background: ${isRecent ? '#fef3c7' : '#f1f5f9'}; color: ${isRecent ? '#b45309' : '#475569'}; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 700; white-space: nowrap;">${period}</span>
                        </div>
                        
                        <ul style="margin: 0 0 1rem 0; padding-left: 1.5rem; color: var(--research-secondary); font-size: 0.9rem;">
                            ${value.events.map(e => `<li style="margin-bottom: 0.25rem;">${e}</li>`).join('')}
                        </ul>
                        
                        ${value.community_response ? `
                            <div style="background: #f0fdf4; border-left: 3px solid #22c55e; padding: 0.75rem 1rem; border-radius: 0 8px 8px 0; margin-top: 0.75rem;">
                                <strong style="color: #15803d; font-size: 0.85rem;"><i class="fab fa-whatsapp" style="color: #25D366;"></i> Community Response:</strong>
                                <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: #475569;">
                                    ${value.community_response.excitement_level || value.community_response.sentiment || value.community_response.overwhelmingly_positive || ''}
                                </p>
                            </div>
                        ` : ''}
                        
                        ${value.community_sentiment ? `
                            <div style="background: #f0fdf4; border-left: 3px solid #22c55e; padding: 0.75rem 1rem; border-radius: 0 8px 8px 0; margin-top: 0.75rem;">
                                <strong style="color: #15803d; font-size: 0.85rem;"><i class="fas fa-heart" style="color: #ef4444;"></i> Emotional Impact:</strong>
                                <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: #475569;">
                                    ${value.community_sentiment.overwhelmingly_positive || ''} ${value.community_sentiment.tears_of_joy || ''}
                                </p>
                            </div>
                        ` : ''}
                        
                        ${value.practical_details ? `
                            <div style="background: #f1f5f9; padding: 0.75rem 1rem; border-radius: 8px; margin-top: 0.75rem;">
                                <strong style="color: #334155; font-size: 0.85rem;"><i class="fas fa-clipboard-list"></i> Practical Details:</strong>
                                <p style="margin: 0.25rem 0 0 0; font-size: 0.85rem; color: #475569;">
                                    ${value.practical_details.process || value.practical_details.cost_to_families || ''}
                                </p>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            html += '</div>';
        }

        // Success Stories
        if (initiatives.success_stories) {
            html += `<div style="margin-bottom: 2.5rem;">
                <h3 style="color: var(--research-accent); font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; border-bottom: 2px solid #fcd34d; padding-bottom: 0.75rem;">
                    <i class="fas fa-star"></i> Community Achievements Summary
                </h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">`;

            initiatives.success_stories.forEach((story, index) => {
                const colors = ['#0077b6', '#059669', '#7c3aed', '#dc2626', '#f59e0b', '#ec4899'];
                const color = colors[index % colors.length];

                html += `
                    <div style="background: white; border-radius: 12px; padding: 1.5rem; border: 1px solid #e2e8f0; border-top: 4px solid ${color}; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <h4 style="color: ${color}; margin: 0 0 0.75rem 0; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                            <i class="fas fa-award"></i>
                            ${story.achievement}
                        </h4>
                        <p style="color: #475569; margin: 0; font-size: 0.9rem; line-height: 1.5;">${story.description}</p>
                    </div>
                `;
            });
            html += '</div></div>';
        }

        container.innerHTML = html;
    }

    // Show Collaboration Modal with Detailed Information
    function showCollaborationModal(collabId) {
        if (!researchData.initiatives || !researchData.initiatives.categories.international_collaborations) return;

        const collab = researchData.initiatives.categories.international_collaborations.find(c => c.id === collabId);
        if (!collab || !collab.detailed_info) return;

        const modal = document.createElement('div');
        modal.className = 'modal-overlay';
        modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;display:flex;align-items:center;justify-content:center;padding:1rem;';

        let modalContent = `
            <div style="background:white;border-radius:16px;max-width:900px;width:100%;max-height:90vh;overflow-y:auto;padding:2rem;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
                    <h2 style="font-size:1.5rem;color:#0f172a;margin:0;">${collab.collaboration_name}</h2>
                    <button onclick="this.closest('.modal-overlay').remove()" style="background:none;border:none;font-size:1.5rem;cursor:pointer;color:#64748b;">&times;</button>
                </div>
                
                <div style="background:#f0f9ff;border-left:4px solid #0077b6;border-radius:8px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p style="color:#0369a1;font-weight:600;margin:0;">${collab.detailed_info.about_target_als || collab.detailed_info.about_alliance || collab.detailed_info.significance || 'Detailed information about this collaboration'}</p>
                </div>`;

        // Target ALS specific content
        if (collabId === 1 && collab.detailed_info.meeting_details) {
            modalContent += `
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-handshake"></i> Meeting Details</h3>
                <div style="background:#f8fafc;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Date:</strong> ${collab.detailed_info.meeting_details.date}</p>
                    <p><strong>Format:</strong> ${collab.detailed_info.meeting_details.format}</p>
                    <p><strong>Participants:</strong> ${collab.detailed_info.meeting_details.participants}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-flask"></i> Global Natural History Study</h3>
                <div style="background:#f0fdf4;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Purpose:</strong> ${collab.detailed_info.global_natural_history_study.purpose}</p>
                    <p><strong>India's Role:</strong> ${collab.detailed_info.global_natural_history_study.india_role}</p>
                    <p><strong>Sample Collection:</strong> ${collab.detailed_info.global_natural_history_study.sample_collection}</p>
                    <h4 style="margin-top:1rem;color:#15803d;">Expected Outcomes:</h4>
                    <ul>${collab.detailed_info.global_natural_history_study.expected_outcomes.map(o => `<li>${o}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-calendar"></i> Annual Conference</h3>
                <div style="background:#fef3c7;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Date:</strong> ${collab.detailed_info.annual_conference.date}</p>
                    <p><strong>Format:</strong> ${collab.detailed_info.annual_conference.format}</p>
                    <p><strong>Focus:</strong> ${collab.detailed_info.annual_conference.focus}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-star"></i> Significance for India</h3>
                <div style="background:#f1f5f9;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.detailed_info.significance_for_india.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>`;
        }

        // IFNR/IAN Event specific content
        if (collabId === 3 && collab.event_details) {
            modalContent += `
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-calendar-alt"></i> Event Details</h3>
                <div style="background:#f8fafc;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Event Name:</strong> ${collab.event_details.name}</p>
                    <p><strong>Organizers:</strong> ${collab.event_details.organizers.join(', ')}</p>
                    <p><strong>Format:</strong> ${collab.event_details.format}</p>
                    <p><strong>Key Organizer:</strong> ${collab.event_details.key_organizer}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-users"></i> Speakers</h3>
                <div style="background:#f0fdf4;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.speakers.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-book-open"></i> Topics Covered</h3>
                <div style="background:#fef3c7;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.topics_covered.map(t => `<li>${t}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-video"></i> Watch Event Recording</h3>
                <div style="background:#f1f5f9;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p style="margin-bottom:1rem;">${collab.detailed_info.impact}</p>
                    <a href="${collab.detailed_info.video_recording}" target="_blank" style="display:inline-block;padding:0.75rem 1.5rem;background:#dc2626;color:white;border-radius:8px;text-decoration:none;font-weight:600;">
                        <i class="fab fa-youtube"></i> Watch on YouTube
                    </a>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-lightbulb"></i> Key Takeaways</h3>
                <div style="background:#f0f9ff;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.detailed_info.key_takeaways.map(k => `<li>${k}</li>`).join('')}</ul>
                </div>`;
        }

        // International Alliance specific content
        if (collabId === 4 && collab.membership_details) {
            modalContent += `
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-award"></i> Membership Achievement</h3>
                <div style="background:#f0fdf4;border-left:4px solid #22c55e;border-radius:8px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Achievement Date:</strong> ${collab.membership_details.achievement_date}</p>
                    <p><strong>Membership Type:</strong> ${collab.membership_details.membership_type}</p>
                    <p><strong>Organization:</strong> ${collab.membership_details.organization_name}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-star"></i> Significance for India</h3>
                <div style="background:#fef3c7;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.detailed_info.significance_for_india.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-gift"></i> Benefits</h3>
                <div style="background:#f0f9ff;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.detailed_info.benefits.map(b => `<li>${b}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-globe"></i> Congress Participation</h3>
                <div style="background:#f1f5f9;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Event:</strong> ${collab.detailed_info.congress_participation.event}</p>
                    <p><strong>Year:</strong> ${collab.detailed_info.congress_participation.year}</p>
                    <p><strong>Significance:</strong> ${collab.detailed_info.congress_participation.significance}</p>
                    <p style="margin-top:0.75rem;padding:0.75rem;background:#e0f2fe;border-radius:8px;color:#0369a1;">
                        <strong>Acknowledgment:</strong> ${collab.detailed_info.congress_participation.acknowledgment}
                    </p>
                </div>`;
        }

        // IHBAS specific content
        if (collabId === 5 && collab.proposed_initiatives) {
            modalContent += `
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-clipboard-list"></i> Proposed Initiatives</h3>
                ${collab.proposed_initiatives.map(init => `
                    <div style="background:#f8fafc;border-radius:12px;padding:1.25rem;margin-bottom:1rem;">
                        <h4 style="color:#0369a1;margin:0 0 0.5rem 0;">${init.name}</h4>
                        <p><strong>Status:</strong> <span style="color:#dc2626;">${init.status}</span></p>
                        <p>${init.description}</p>
                    </div>
                `).join('')}

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;margin-top:1.5rem;"><i class="fas fa-hospital-alt"></i> Proposed ALS Clinic</h3>
                <div style="background:#f0fdf4;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Purpose:</strong> ${collab.detailed_info.proposed_als_clinic.purpose}</p>
                    <h4 style="margin-top:1rem;color:#15803d;">Services:</h4>
                    <ul>${collab.detailed_info.proposed_als_clinic.services.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-chart-line"></i> Patient Needs Study</h3>
                <div style="background:#fef3c7;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Objective:</strong> ${collab.detailed_info.patient_needs_study.objective}</p>
                    <h4 style="margin-top:1rem;">Expected Outcomes:</h4>
                    <ul>${collab.detailed_info.patient_needs_study.expected_outcomes.map(o => `<li>${o}</li>`).join('')}</ul>
                </div>

                <div style="background:#f0f9ff;border-left:4px solid #0077b6;border-radius:8px;padding:1.25rem;">
                    <p style="color:#0369a1;font-weight:600;margin:0;"><i class="fas fa-exclamation-circle"></i> ${collab.detailed_info.significance}</p>
                </div>`;
        }

        // AKV9 specific content
        if (collabId === 6 && collab.about_akv9) {
            modalContent += `
                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-pills"></i> About AKV9</h3>
                <div style="background:#f8fafc;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Original Name:</strong> ${collab.about_akv9.original_name}</p>
                    <p><strong>Current Name:</strong> ${collab.about_akv9.current_name}</p>
                    <p><strong>Type:</strong> ${collab.about_akv9.type}</p>
                    <p><strong>Target:</strong> ${collab.about_akv9.target}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-flask"></i> Research Background</h3>
                <div style="background:#f0fdf4;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Preclinical Results:</strong> ${collab.research_background.preclinical_results}</p>
                    <p style="margin-top:0.75rem;padding:0.75rem;background:#d1fae5;border-radius:8px;color:#15803d;">
                        <strong>Unique Aspect:</strong> ${collab.research_background.unique_aspect}
                    </p>
                    <p><strong>Development Stage:</strong> ${collab.research_background.development_stage}</p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-handshake"></i> India Collaboration</h3>
                <div style="background:#fef3c7;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Meeting Date:</strong> ${collab.detailed_info.india_collaboration.meeting_date}</p>
                    <p><strong>Location:</strong> ${collab.detailed_info.india_collaboration.location}</p>
                    <p><strong>Participants:</strong> ${collab.detailed_info.india_collaboration.participants}</p>
                    <h4 style="margin-top:1rem;">Discussion Topics:</h4>
                    <ul>${collab.detailed_info.india_collaboration.discussion_topics.map(t => `<li>${t}</li>`).join('')}</ul>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-chart-line"></i> Current Status</h3>
                <div style="background:#f0f9ff;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <p><strong>Phase:</strong> ${collab.detailed_info.current_status.phase}</p>
                    <p><strong>Next Steps:</strong> ${collab.detailed_info.current_status.next_steps}</p>
                    <p style="margin-top:0.75rem;padding:0.75rem;background:#e0f2fe;border-radius:8px;color:#0369a1;">
                        <strong>India Opportunity:</strong> ${collab.detailed_info.current_status.india_opportunity}
                    </p>
                </div>

                <h3 style="color:#0077b6;font-size:1.1rem;margin-bottom:1rem;"><i class="fas fa-star"></i> Significance for India</h3>
                <div style="background:#f1f5f9;border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;">
                    <ul>${collab.detailed_info.significance_for_india.map(s => `<li>${s}</li>`).join('')}</ul>
                </div>`;
        }

        modalContent += `
                <div style="text-align:center;margin-top:1.5rem;">
                    <button onclick="this.closest('.modal-overlay').remove()" style="padding:0.75rem 2rem;background:#0077b6;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;">Close</button>
                </div>
            </div>
        `;

        modal.innerHTML = modalContent;
        modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
        document.body.appendChild(modal);
    }

    // Render Research Hubs
    function renderResearchHubs() {
        const container = document.getElementById('researchHubsList');
        const hubs = researchData.key_research_hubs_india;

        container.innerHTML = hubs.map(hub => `
            <div class="hub-card">
                <h3><i class="fas fa-hospital"></i> ${hub.institution || hub.service}</h3>
                ${hub.lead_researcher ? `<p><strong>Lead Researcher:</strong> ${hub.lead_researcher}</p>` : ''}
                ${hub.participation ? `<p><strong>Participation:</strong> ${hub.participation}</p>` : ''}
                ${hub.description ? `<p>${hub.description}</p>` : ''}
                ${hub.services ? `
                    <p><strong>Services:</strong></p>
                    <ul>
                        ${hub.services.map(service => `<li>${service}</li>`).join('')}
                    </ul>
                ` : ''}
            </div>
        `).join('');
    }

    // Render Important Notes
    function renderImportantNotes() {
        const container = document.getElementById('importantNotesList');
        const notes = researchData.important_notes;

        const notesHTML = Object.entries(notes).map(([key, value]) => {
            const title = key.split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
            const isWarning = key.includes('warning') || key.includes('caution');

            return `
                <div class="${isWarning ? 'warning-box' : 'note-box'}" style="margin-bottom: 1rem;">
                    <strong><i class="fas fa-${isWarning ? 'exclamation-triangle' : 'info-circle'}"></i> ${title}</strong>
                    <p>${value}</p>
                </div>
            `;
        }).join('');

        container.innerHTML = notesHTML;
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', loadResearchData);
</script>
{% endblock %}